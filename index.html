<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æˆ‘çš„ç¬”è®°ç³»ç»Ÿ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.2.4/fabric.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    #sidebar {
      width: 260px;
      border-right: 1px solid #ccc;
      padding: 10px;
      background: #f8f8f8;
      overflow-y: auto;
    }
    #main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    #toolbar, #richbar {
      margin-bottom: 10px;
    }
    #toolbar button, #richbar button {
      margin-right: 6px;
      margin-bottom: 5px;
    }
    #pages {
      max-width: 850px;
      margin: auto;
    }
    .page {
      width: 794px;
      height: 1123px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
      position: relative;
      background: #fff;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
    }
    .text-layer {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      padding: 40px;
      box-sizing: border-box;
      z-index: 1;
      outline: none;
      overflow: auto;
    }
    canvas.draw-layer {
      position: absolute;
      top: 0; left: 0;
      z-index: 10;
      pointer-events: none;
    }
    .folder, .note {
      margin: 4px 0;
      padding: 4px 6px;
      cursor: pointer;
      border-radius: 4px;
    }
    .folder:hover, .note:hover {
      background: #e6f7ff;
    }
    .folder-title {
      font-weight: bold;
      margin-top: 10px;
    }
    .note-actions {
      display: inline-block;
      margin-left: 10px;
    }
    .page.selected {
      box-shadow: 0 0 10px #1890ff;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 5px;
      width: 80%;
      max-width: 600px;
    }
    #ai-question {
      width: 100%;
      height: 100px;
      margin: 10px 0;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    #ai-response {
      margin-top: 15px;
      padding: 10px;
      border: 1px solid #eee;
      border-radius: 4px;
      min-height: 100px;
      max-height: 300px;
      overflow-y: auto;
    }
    .quick-actions {
      margin: 10px 0;
      display: flex;
      gap: 10px;
    }
    @keyframes thinking {
      0% { content: "æ€è€ƒä¸­"; }
      25% { content: "æ€è€ƒä¸­."; }
      50% { content: "æ€è€ƒä¸­.."; }
      75% { content: "æ€è€ƒä¸­..."; }
    }
    #ai-response:before {
      content: "æ€è€ƒä¸­";
      animation: thinking 1.5s infinite;
    }
  </style>
</head>
<body>

<div id="sidebar">
  <h3>ğŸ“ æ–‡ä»¶ç®¡ç†</h3>
  <button onclick="createFolder()">ğŸ“‚ æ–°å»ºæ–‡ä»¶å¤¹</button>
  <ul id="folder-list"></ul>
</div>

<div id="main">
  <h2 id="note-title">æœªå‘½åç¬”è®°</h2>

  <div id="toolbar">
    <button onclick="switchMode('text')">ğŸ“ æ–‡å­—æ¨¡å¼</button>
    <button onclick="switchMode('draw')">âœï¸ ç»˜å›¾æ¨¡å¼</button>
    <button onclick="switchMode('select')">ğŸ–± å¯¹è±¡æ¨¡å¼</button>
    <button onclick="deleteSelected()">ğŸ—‘ åˆ é™¤é€‰ä¸­</button>
    <button onclick="addPage()">â• æ·»åŠ é¡µé¢</button>
    <button onclick="insertImage()">ğŸ–¼ æ’å›¾</button>
    <button onclick="cropImage()">âœ‚ï¸ è£å‰ªå›¾åƒ</button>
    <button onclick="deleteSelectedPage()">ğŸ—‘ åˆ é™¤å½“å‰é¡µ</button>
    <button onclick="saveNote()">ğŸ’¾ æ‰‹åŠ¨ä¿å­˜</button>
    <button onclick="exportPage()">ğŸ“· å¯¼å‡ºå½“å‰é¡µ</button>
    <button id="ai-assistant">ğŸ¤– AIåŠ©æ‰‹</button>
    <input type="file" id="img-file" accept="image/*" style="display:none">
  </div>

  <div id="draw-controls" style="margin-bottom: 10px;">
    <label>ğŸ–Œ é¢œè‰²ï¼š<input type="color" id="draw-color" value="#000000"></label>
    <label style="margin-left: 10px;">ç²—ç»†ï¼š<input type="range" id="draw-size" min="1" max="20" value="2"></label>
  </div>

  <div id="richbar">
    <button onclick="execCmd('bold')">åŠ ç²—</button>
    <button onclick="execCmd('italic')">æ–œä½“</button>
    <button onclick="execCmd('underline')">ä¸‹åˆ’çº¿</button>
    <button onclick="setTextColor()">æ–‡å­—é¢œè‰²</button>
    <button onclick="setHighlightColor()">é«˜äº®</button>
  </div>

  <div id="pages"></div>
</div>

<!-- AI é¢æ¿ -->
<div id="ai-panel" class="modal" style="display:none;">
  <div class="modal-content">
    <h3>AI åŠ©æ‰‹</h3>
    <textarea id="ai-question" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜..."></textarea>
    <div class="quick-actions">
      <button onclick="setPrompt('æ€»ç»“å½“å‰ç¬”è®°')">ğŸ“ æ€»ç»“</button>
      <button onclick="setPrompt('åˆ—å‡ºå…³é”®ç‚¹')">ğŸ”‘ å…³é”®ç‚¹</button>
      <button onclick="setPrompt('ä¼˜åŒ–è¿™æ®µè¡¨è¿°')">âœ¨ ä¼˜åŒ–</button>
      <button onclick="setPrompt('ç”Ÿæˆæ€ç»´å¯¼å›¾')">ğŸ§  æ€ç»´å¯¼å›¾</button>
    </div>
    <div style="display:flex; gap:10px; margin-top:10px;">
      <button onclick="askAI()" style="flex:1; background:#1890ff; color:white;">æé—®</button>
      <button onclick="closeAIPanel()" style="flex:1; background:#f5222d; color:white;">å…³é—­</button>
    </div>
    <div id="ai-response"></div>
    <button onclick="saveConversation()" style="margin-top:15px; width:100%;">ğŸ’¾ ä¿å­˜å¯¹è¯</button>
  </div>
</div>

<script>
// å…¨å±€å˜é‡
let folders = JSON.parse(localStorage.getItem('myFolders') || '{}');
let canvases = {};
let pageCount = 0;
let currentFolder = null, currentNote = null, currentMode = 'text';
let conversationHistory = [];

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
  renderFolders();
  setupEventListeners();
});

function setupEventListeners() {
  document.getElementById('ai-assistant').addEventListener('click', () => {
    document.getElementById('ai-panel').style.display = 'flex';
  });
  
  document.querySelector('#ai-panel button:first-child').addEventListener('click', askAI);
  document.querySelector('#ai-panel button:last-child').addEventListener('click', closeAIPanel);
  
  document.getElementById('draw-color').addEventListener('input', (e) => {
    updateDrawingBrush('color', e.target.value);
  });
  
  document.getElementById('draw-size').addEventListener('input', (e) => {
    updateDrawingBrush('width', parseInt(e.target.value));
  });
}

// æ ¸å¿ƒåŠŸèƒ½å‡½æ•°
function saveToStorage() {
  localStorage.setItem('myFolders', JSON.stringify(folders));
}

function renderFolders() {
  const list = document.getElementById('folder-list');
  list.innerHTML = '';
  
  Object.keys(folders).forEach(folder => {
    const div = document.createElement('div');
    div.className = 'folder';
    div.innerHTML = `<div class="folder-title">${folder}</div>`;
    
    const ul = document.createElement('ul');
    Object.keys(folders[folder].notes).forEach(id => {
      const li = document.createElement('li');
      li.className = 'note';
      li.innerHTML = `
        <span onclick="loadNote('${folder}','${id}')">${folders[folder].notes[id].title}</span>
        <span class="note-actions">
          <button onclick="renameNote(event, '${folder}', '${id}')">âœ</button>
          <button onclick="deleteNote(event, '${folder}', '${id}')">ğŸ—‘</button>
        </span>`;
      ul.appendChild(li);
    });
    
    const newBtn = document.createElement('button');
    newBtn.textContent = 'ğŸ“ æ–°å»ºç¬”è®°';
    newBtn.onclick = () => createNote(folder);
    div.appendChild(newBtn);
    div.appendChild(ul);
    list.appendChild(div);
  });
}

// æ–‡ä»¶å¤¹å’Œç¬”è®°æ“ä½œ
async function createFolder() {
  const folderName = await showInputDialog("æ–°å»ºæ–‡ä»¶å¤¹", "è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°");
  if (!folderName) return;
  
  if (folders[folderName]) {
    alert("æ–‡ä»¶å¤¹å·²å­˜åœ¨ï¼");
    return;
  }
  
  folders[folderName] = { notes: {} };
  saveToStorage();
  renderFolders();
}

async function createNote(folder) {
  const title = await showInputDialog("æ–°å»ºç¬”è®°", "ç¬”è®°æ ‡é¢˜ï¼š");
  if (!title) return;
  
  const id = 'note_' + Date.now();
  folders[folder].notes[id] = { title, pages: [] };
  saveToStorage();
  loadNote(folder, id);
}

function loadNote(folder, noteId) {
  saveNote(); // åˆ‡æ¢æ—¶ä¿å­˜ä¸Šä¸€ä¸ª
  currentFolder = folder;
  currentNote = noteId;
  const note = folders[folder].notes[noteId];
  document.getElementById('note-title').textContent = note.title;
  const pages = document.getElementById('pages');
  pages.innerHTML = '';
  canvases = {}; pageCount = 0;
  note.pages.forEach((page, index) => {
    const pid = createPage(page.textHTML);
    canvases[pid].loadFromJSON(page.canvasJSON, canvases[pid].renderAll.bind(canvases[pid]));
  });
  if (note.pages.length === 0) addPage(); // å¦‚æœæ˜¯ç©ºç¬”è®°åˆ™åŠ ä¸€é¡µ
  switchMode(currentMode);
}

function saveNote() {
  if (!currentFolder || !currentNote) return;
  const note = folders[currentFolder].notes[currentNote];
  note.pages = [];
  for (let i = 1; i <= pageCount; i++) {
    note.pages.push({
      textHTML: document.getElementById(`text-${i}`).innerHTML,
      canvasJSON: canvases[i].toJSON()
    });
  }
  saveToStorage();
}

function createPage(initText = '') {
  pageCount++;
  const pages = document.getElementById('pages');
  const page = document.createElement('div');
  page.className = 'page';
page.onclick = () => {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('selected'));
    page.classList.add('selected');
  };
  const text = document.createElement('div');
  text.className = 'text-layer';
  text.id = `text-${pageCount}`;
  text.contentEditable = true;
  text.innerHTML = initText || `<p>ç¬¬ ${pageCount} é¡µå†…å®¹...</p >`;
  const canvasEl = document.createElement('canvas');
  canvasEl.className = 'draw-layer';
  canvasEl.id = `canvas-${pageCount}`;
  canvasEl.width = 794;
  canvasEl.height = 1123;
  page.appendChild(text);
  page.appendChild(canvasEl);
  pages.appendChild(page);
  const canvas = new fabric.Canvas(canvasEl.id, { isDrawingMode: false });
  canvas.freeDrawingBrush.width = 2;
  canvas.freeDrawingBrush.color = '#000';
  canvases[pageCount] = canvas;
  return pageCount;
}

function addPage() {
  createPage();
  switchMode(currentMode);
  saveNote();
}

function switchMode(mode) {
  currentMode = mode;
  for (let i = 1; i <= pageCount; i++) {
    const canvas = canvases[i];
    const u = canvas.upperCanvasEl;
    if (mode === 'text') u.style.pointerEvents = 'none';
    else u.style.pointerEvents = 'auto';
    canvas.freeDrawingBrush.color = document.getElementById('draw-color').value;
    canvas.freeDrawingBrush.width = parseInt(document.getElementById('draw-size').value);
    canvas.isDrawingMode = (mode === 'draw');
  }
}

function deleteSelected() {
  for (let i = 1; i <= pageCount; i++) {
    const c = canvases[i];
    if (c.getActiveObjects().length > 0) {
  c.getActiveObjects().forEach(obj => c.remove(obj));
  c.discardActiveObject().renderAll();
}
  }
}

function insertImage() {
  document.getElementById('img-file').click();
}

document.getElementById('img-file').onchange = e => {
  const file = e.target.files[0];
  if (!file) return;

  const selected = document.querySelector('.page.selected');
  if (!selected) return alert('è¯·å…ˆç‚¹å‡»é€‰ä¸­ä¸€ä¸ªé¡µé¢');
  const pid = parseInt(selected.querySelector('canvas').id.split('-')[1]);
  const canvas = canvases[pid];

  const reader = new FileReader();
  reader.onload = f => {
    const imgUrl = f.target.result;
    fabric.Image.fromURL(imgUrl, function(img) {
      img.set({
        left: 100,
        top: 100,
        scaleX: 0.4,
        scaleY: 0.4,
        selectable: true
      });
      canvas.add(img);
      canvas.setActiveObject(img);
      canvas.renderAll();
    }, { crossOrigin: 'anonymous' });
  };
  reader.readAsDataURL(file);
};

function cropImage() {
  const selected = document.querySelector('.page.selected');
  if (!selected) return alert('è¯·å…ˆé€‰ä¸­é¡µé¢');

  const pid = parseInt(selected.querySelector('canvas').id.split('-')[1]);
  const canvas = canvases[pid];
  const active = canvas.getActiveObject();
  if (!active || active.type !== 'image') {
    return alert('è¯·é€‰ä¸­ä¸€ä¸ªå›¾ç‰‡å¯¹è±¡');
  }

  const cropped = new fabric.Image(active.getElement(), {
    left: active.left,
    top: active.top,
    angle: active.angle,
    scaleX: active.scaleX,
    scaleY: active.scaleY,
    cropX: 50, // ä»å·¦è£50åƒç´ 
    cropY: 50, // ä»ä¸Šè£50åƒç´ 
    width: 200,
    height: 200
  });

  canvas.remove(active);
  canvas.add(cropped).setActiveObject(cropped);
}

function exportPage() {
  const selectedPage = document.querySelector('.page.selected') || document.querySelector('.page:last-child');
  if (!selectedPage) return alert("æ²¡æœ‰é€‰ä¸­çš„é¡µé¢ï¼");
  html2canvas(selectedPage).then(canvas => {
    const link = document.createElement('a');
    link.download = 'note_page.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}

function execCmd(cmd, val = null) {
  document.execCommand(cmd, false, val);
}

function renameNote(e, folder, id) {
  e.stopPropagation();
  const newTitle = prompt('æ–°æ ‡é¢˜ï¼š');
  if (!newTitle) return;
  folders[folder].notes[id].title = newTitle;
  saveToStorage();
  renderFolders();
}

function deleteSelectedPage() {
  const selected = document.querySelector('.page.selected');
  if (!selected) return alert("è¯·å…ˆç‚¹å‡»é€‰ä¸­è¦åˆ é™¤çš„é¡µé¢");
  const idx = Array.from(document.querySelectorAll('.page')).indexOf(selected) + 1;
  delete canvases[idx];
  selected.remove();
  pageCount--;
  saveNote();
}

function deleteNote(e, folder, id) {
  e.stopPropagation();
  if (!confirm('ç¡®å®šåˆ é™¤æ­¤ç¬”è®°ï¼Ÿ')) return;
  delete folders[folder].notes[id];
  saveToStorage();
  renderFolders();
  if (currentNote === id) {
    document.getElementById('pages').innerHTML = '';
    document.getElementById('note-title').textContent = 'æœªå‘½åç¬”è®°';
  }
}

// è®¾ç½®ç”»ç¬”é¢œè‰²
document.getElementById('draw-color').oninput = e => {
  for (let i = 1; i <= pageCount; i++) {
    canvases[i].freeDrawingBrush.color = e.target.value;
  }
};

// è®¾ç½®ç”»ç¬”ç²—ç»†
document.getElementById('draw-size').oninput = e => {
  for (let i = 1; i <= pageCount; i++) {
    canvases[i].freeDrawingBrush.width = parseInt(e.target.value);
  }
};

window.addEventListener('beforeunload', saveNote);
renderFolders();

// å…¨å±€å˜é‡å­˜å‚¨API Keyï¼ˆå®é™…é¡¹ç›®å»ºè®®ç”¨æ›´å®‰å…¨çš„æ–¹å¼ï¼‰
let DEEPSEEK_API_KEY = "NOTEAI_API_KEY1"; // æ›¿æ¢ä¸ºæ‚¨çš„çœŸå®Key

// æ‰“å¼€/å…³é—­AIé¢æ¿
document.getElementById('ai-assistant').addEventListener('click', () => {
  document.getElementById('ai-panel').style.display = 'flex';
});

// å•ç‹¬ç»‘å®šæé—®æŒ‰é’®ï¼ˆé¿å…HTMLä¸­çš„onclickï¼‰
document.querySelector('#ai-panel button:first-child').addEventListener('click', askAI);
document.querySelector('#ai-panel button:last-child').addEventListener('click', closeAIPanel);

function closeAIPanel() {
  document.getElementById('ai-panel').style.display = 'none';
}


let conversationHistory = [];
// æ ¸å¿ƒAIæé—®å‡½æ•°
async function askAI() {
  const question = document.getElementById('ai-question').value;
  const responseDiv = document.getElementById('ai-response');
  
  if (!question.trim()) {
    responseDiv.innerHTML = '<p style="color:red">è¯·è¾“å…¥é—®é¢˜</p>';
    return;
  }

  responseDiv.innerHTML = '<p>æ€è€ƒä¸­...</p>';
    try {
    // æ·»åŠ åˆ°å†å²
    conversationHistory.push({
      role: "user",
      content: question,
      timestamp: new Date().toLocaleTimeString()
    });
    
    // ...APIè°ƒç”¨...
      
  try {
    const noteContent = document.querySelector('.text-layer').innerText;


const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'NOTEAI_API_KEY2' // æ›¿æ¢ä¸ºæ‚¨çš„Key
      },
      body: JSON.stringify({
        model: "mistralai/mistral-7b-instruct", // å…è´¹æ¨¡å‹
        messages: [
          {
            role: "system",
            content: "ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½ç¬”è®°åŠ©æ‰‹ï¼Œå½“å‰ç¬”è®°å†…å®¹ï¼š" + 
                     noteContent.substring(0, 2000)
          },
          {
            role: "user",
            content: question
          }
        ]
      })
    });

    const data = await response.json();
    
    if (data?.choices?.[0]?.message?.content) {
      // ç¾åŒ–AIå“åº”æ ¼å¼
      const formattedResponse = formatAIResponse(data.choices[0].message.content);
      responseDiv.innerHTML = formattedResponse;
    } else {
      throw new Error('APIè¿”å›æ•°æ®æ ¼å¼å¼‚å¸¸');
    }
  } catch (error) {
    // é”™è¯¯å¤„ç†ï¼ˆä¿æŒæ¨¡æ‹Ÿæ¨¡å¼ä½œä¸ºåå¤‡ï¼‰
    console.error('APIè°ƒç”¨å¤±è´¥:', error);
    responseDiv.innerHTML = `
      <p style="color:red">æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œå·²å¯ç”¨æ¨¡æ‹Ÿæ¨¡å¼</p>
      <p>${generateMockResponse(question)}</p>
    `;
  }
}

// æ ¼å¼åŒ–AIå“åº”
function formatAIResponse(text) {
  // å°†Markdownè½¬æ¢ä¸ºç®€å•HTML
  return text
    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // åŠ ç²—
    .replace(/\*(.*?)\*/g, '<em>$1</em>') // æ–œä½“
    .replace(/^- (.*$)/gm, '<li>$1</li>') // åˆ—è¡¨
    .replace(/\n/g, '<br>');
}

// æ›´æ™ºèƒ½çš„æ¨¡æ‹Ÿå“åº”
function generateMockResponse(question) {
  const responses = [
    `æ ¹æ®æ‚¨çš„ç¬”è®°ï¼Œå…³äº"${question}"çš„å…³é”®ç‚¹æœ‰ï¼š<br>
    1. æ ¸å¿ƒæ¦‚å¿µA<br>
    2. é‡è¦åŸç†B<br>
    3. åº”ç”¨ç¤ºä¾‹C`,
    
    `é’ˆå¯¹"${question}"çš„å»ºè®®ï¼š<br>
    - è€ƒè™‘å¢åŠ å›¾è¡¨è¯´æ˜<br>
    - è¡¥å……ç›¸å…³æ¡ˆä¾‹<br>
    - ç²¾ç‚¼é‡ç‚¹è¡¨è¿°`,
    
    `ç¬”è®°åˆ†æï¼š<br>
    æ‚¨å½“å‰ç¬”è®°åŒ…å«3ä¸ªä¸»è¦éƒ¨åˆ†ï¼š<br>
    <ul>
      <li>ç†è®ºæ¡†æ¶</li>
      <li>å®è·µæ–¹æ³•</li>
      <li>é—®é¢˜è§£å†³æ–¹æ¡ˆ</li>
    </ul>`
  ];
  
  return responses[Math.floor(Math.random() * responses.length)];
}
    // ä¿å­˜AIå“åº”
    conversationHistory.push({
      role: "assistant",
      content: data.choices[0].message.content,
      timestamp: new Date().toLocaleTimeString()
    });
    
    // æ˜¾ç¤ºå®Œæ•´å¯¹è¯
    renderConversation();
  } 

    if (mockData?.choices?.[0]?.message?.content) {
      responseDiv.innerHTML = `<p>${mockData.choices[0].message.content.replace(/\n/g, '<br>')}</p>`;
    } else {
      throw new Error('APIè¿”å›æ•°æ®æ ¼å¼å¼‚å¸¸');
    }
  } catch (error) {
    console.error('é”™è¯¯è¯¦æƒ…:', error);
    responseDiv.innerHTML = `
      <p style="color:red">
        ${error.message}<br>
        <small>å½“å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®æ¨¡å¼</small>
      </p>
    `;
  }
}

  function renderConversation() {
  const historyHTML = conversationHistory.map(msg => `
    <div class="message ${msg.role}" style="margin-bottom: 10px;">
      <div style="font-weight: bold; color: ${msg.role === 'user' ? '#1890ff' : '#52c41a'}">
        ${msg.role === 'user' ? 'æ‚¨' : 'AIåŠ©æ‰‹'} 
        <small>(${msg.timestamp})</small>
      </div>
      <div>${formatAIResponse(msg.content)}</div>
    </div>
  `).join('');
  
  document.getElementById('ai-response').innerHTML = historyHTML;
  // æ»šåŠ¨åˆ°åº•éƒ¨
  document.getElementById('ai-response').scrollTop = document.getElementById('ai-response').scrollHeight;
}

  function saveConversation() {
  if (conversationHistory.length === 0) return;
  
  const content = conversationHistory.map(msg => 
    `[${msg.timestamp}] ${msg.role}: ${msg.content}`
  ).join('\n\n');
  
  // åœ¨å½“å‰ç¬”è®°ä¸­æ’å…¥å¯¹è¯
  const textLayer = document.querySelector('.text-layer');
  textLayer.innerHTML += `<div class="ai-conversation">
    <h3>AIå¯¹è¯è®°å½•</h3>
    <pre>${content}</pre>
  </div>`;
  
  alert('å¯¹è¯å·²ä¿å­˜åˆ°ç¬”è®°ä¸­ï¼');
}

// è®¾ç½®å¿«æ·æŒ‡ä»¤
function setPrompt(text) {
  document.getElementById('ai-question').value = text;
  askAI(); // è‡ªåŠ¨æé—®
}
  
</script>
</body>
</html>
